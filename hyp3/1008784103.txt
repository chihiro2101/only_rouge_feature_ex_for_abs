for example , as light rays pass through a wine glass sitting on a table , they are refracted and patterns of light are visible on the table photon mapping is particularly adept at handling this effect because the algorithm reflects photons from one surface to another based on that surface 's bidirectional reflectance distribution function ( brdf ) , and thus light from one object striking another is a natural result of the method photon mapping differs though in that it separates the light transport from the nature of the geometry in the scene this was the original way jensen implemented it ; however , the method becomes slow for highly scattering materials , and bidirectional surface scattering reflectance distribution functions ( bssrdfs ) are more efficient in these situations whenever a photon intersects with a surface , the intersection point and incoming direction are stored in a cache called the photon map once the photon map is constructed ( or during construction ) , it is typically arranged in a manner that is optimal for the k-nearest neighbor algorithm , as photon look-up time depends on the spatial distribution of the photons in this step of the algorithm , the photon map created in the first pass is used to estimate the radiance of every pixel of the output image for an accurate estimate of direct illumination , a ray is traced from the point of intersection to each light source the number of photons in this map must be sufficiently large , as the map is the only source for caustics information in the scene there are many other refinements that can be made to the algorithm : for example , choosing the number of photons to send , and where and in what pattern to send them during the photon mapping process , when a photon strikes a surface , in addition to the usual operations performed , a shadow photon is emitted in the same direction the original photon came from that goes all the way through the object 