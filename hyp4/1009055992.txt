according to the chronicle of alfonso iii , credited to ramiro 's grandson , the childless alfonso ii chose as his successor ramiro , his distant kinsman and son of alfonso 's predecessor bermudo i in 844 , a fleet disembarked in corunna , and began to raid the countryside , burning and pillaging according to the legend , during the battle , saint james the greater , the moor-slayer , is said to have appeared riding a white horse and bearing a white standard , and aided asturian troops to defeat the moors the chronicle of his grandson asserts that when alfonso ii died , ramiro was in the castilian lands for his wedding , suggesting that his wife was castilian 